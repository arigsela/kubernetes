# IAM Policy Attachment via Crossplane
# Links the oncall-agent-nat-monitor-policy to the oncall-agent-nat-monitor user
# Uses Crossplane references to ensure proper dependency ordering

apiVersion: iam.aws.upbound.io/v1beta1
kind: UserPolicyAttachment
metadata:
  name: oncall-agent-nat-monitor-attachment
  labels:
    app: oncall-agent
    component: iam-policy-attachment
    managed-by: crossplane
spec:
  forProvider:
    # Reference the policy by ARN selector
    policyArnSelector:
      matchLabels:
        app: oncall-agent
        component: iam-policy
    # Reference the user by name
    userRef:
      name: oncall-agent-nat-monitor
  providerConfigRef:
    name: default
